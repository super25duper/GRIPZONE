<!DOCTYPE html><html lang="he">
<head>
    <meta charset="UTF-8">
    <title>משאב מוגן</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .error { color: red; font-weight: bold; }
        .ok { color: green; font-size: 22px; }
    </style>
</head>
<body><h2>בדיקת גישה</h2>
<div id="status">בודק גישה...</div><script>
    // קבלת token מה-URL (מ-Kodular)
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");

    const statusDiv = document.getElementById("status");

    if (!token) {
        statusDiv.innerHTML = "<span class='error'>גישה חסומה (אין טוקן)</span>";
        throw new Error("No token");
    }

    statusDiv.innerText = "נמצא טוקן. בודק מול Firebase...";

    // URL של Firebase Realtime Database שלך
    const firebaseUrl = `https://big-one-92549-default-rtdb.firebaseio.com/users.json`;

    fetch(firebaseUrl)
        .then(res => res.json())
        .then(data => {
            let found = false;
            for (let key in data) {
                if (data[key].token === token && data[key].approved === true) {
                    found = true;
                    break;
                }
            }

            if (found) {
                statusDiv.innerHTML = "<span class='ok'>ברוך הבא! המשאב מוצג:</span>" +
                    "<div style='width:100px;height:100px;background:green;margin-top:10px;'></div>";
            } else {
                statusDiv.innerHTML = "<span class='error'>גישה חסומה (token לא חוקי או לא מאושר)</span>";
            }
        })
        .catch(err => {
            console.error(err);
            statusDiv.innerHTML = "<span class='error'>שגיאה בטעינת הנתונים</span>";
        });
</script></body>
</html>
